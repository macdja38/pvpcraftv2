{"version":3,"sources":["../../src/lib/CommandParser.js"],"names":["regArgs","regFlagsAndOptions","getPrefix","content","prefixes","id","m","trim","i","indexOf","toLowerCase","substr","length","prefix","mentionRegex","RegExp","test","replace","dissectMessage","args","exec","split","splice","command","shift","flags","options","myArray","concat","parse","message","channel","user","author","prefixResult","info"],"mappings":"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","file":"CommandParser.js","sourcesContent":["/**\n * Created by macdja38 on 2016-08-08.\n */\n\"use strict\";\nimport \"babel-core/register\";\nimport \"source-map-support/register\";\n\nimport Command from \"../Types/userCommand\";\nimport { clean } from \"../utils/utils.js\"\n\nconst regArgs = /^((?:.|\\n)*?)(?= -|$)/;\nconst regFlagsAndOptions = /(?:(?:\\s--)(\\w+).(\\n|.*?)(?= -|\\n|$)|(?:\\s-)([^-]*?)(?= -|\\n|$))/g;\n\nexport const getPrefix = function (content, prefixes, id) {\n  var m = content.trim();\n  for (let i in prefixes) {\n    if (m.indexOf(prefixes[i].toLowerCase()) === 0) {\n      m = m.substr(prefixes[i].length);\n      return { prefix: clean(prefixes[i]), content: m };\n    }\n  }\n  // see if the user is mentioned\n  let mentionRegex = new RegExp(`^<@!?${id}>`);\n  if (mentionRegex.test(m)) {\n    m = m.replace(mentionRegex, \"\");\n    return { prefix: `<@${id}>`, content: m };\n  }\n  return false;\n};\n\nexport const dissectMessage = function (content) {\n  let args = regArgs.exec(content)[1].trim().split(\" \");\n  for (let i of args) {\n    if (args[i] === \"\") {\n      args.splice(i, 1);\n    }\n  }\n  let command = args.shift();\n  let flags = [];\n  let options = [];\n  var myArray;\n  while ((myArray = regFlagsAndOptions.exec(content)) !== null) {\n    if (myArray[1] && myArray[2]) {\n      options[myArray[1]] = myArray[2];\n    }\n    if (myArray[3]) {\n      flags = flags.concat(myArray[3].split(\"\"));\n    }\n  }\n  return { command, args, options, flags }\n};\n\nexport const parse = function ({message, channel, prefixes, id}) {\n  let options = {};\n  options.content = message.content;\n  options.channel = channel;\n  options.message = message;\n  options.user = message.author;\n  let prefixResult = getPrefix(options.content, prefixes, id);\n  if (prefixResult) {\n    options.content = prefixResult.content;\n    options.prefix = prefixResult.prefix;\n    let info = dissectMessage(options.content);\n    if (info) {\n      options.command = info.command;\n      options.args = info.args;\n      options.options = info.args;\n      options.flags = info.flags;\n    }\n  }\n  return new Command(options);\n};\n\nexport default parse;"]}