{"version":3,"sources":["../../src/adapters/Discordjs.js"],"names":["DiscordjsAdapter","constructor","configJSON","adapterSettings","_configJSON","_adapterSettings","_client","Client","name","login","on","console","error","e","auth","token","startEvents","log","user","username","message","_commandHandler","onMessage","DiscordjsMessage","author","content","adapter","member","DiscordjsMember","_message","guild","DiscordjsGuild","DiscordjsUser","_guild","highestRole","members","find","_user","id","replace","roles","reduce","prev","role","position"],"mappings":"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","file":"Discordjs.js","sourcesContent":["/**\n * Created by macdja38 on 2016-09-18.\n */\n\n\"use strict\";\nimport \"babel-core/register\";\nimport \"source-map-support/register\";\n\nimport Adapter from \"./Adapter\";\nimport Discord from \"discord.js\";\nimport Message from \"../events/Message\";\nimport Guild from \"../events/Guild\";\nimport User from \"../events/User\";\n\nexport default class DiscordjsAdapter extends Adapter {\n  constructor({configJSON, adapterSettings}) {\n    super();\n    //noinspection JSUnresolvedVariable\n    this._configJSON = configJSON;\n    this._adapterSettings = adapterSettings;\n    this._client = new Discord.Client();\n  }\n\n  static get name() {\n    return \"discordjs\";\n  }\n\n  async login() {\n    this._client.on(\"error\", e => console.error(\"Discordjs error\", e));\n    await this._client.login(this._adapterSettings.auth.token);\n    this.startEvents();\n  }\n\n  startEvents() {\n    this._client.on(\"ready\", () => {\n      /* eslint-disable */\n      console.log(`Connected as: ${this._client.user.username}`);\n      /* eslint-enable */\n    });\n\n    this._client.on(\"message\", message => {\n      this._commandHandler.onMessage(new DiscordjsMessage(message));\n      console.log(`discordjs ${this._client.user.username} ${message.author.username} ${message.content}`);\n    });\n  }\n}\n\nclass DiscordjsMessage extends Message {\n  constructor(message) {\n    super(message);\n  }\n\n  get adapter() {\n    return \"discordjs\"\n  }\n\n  get member() {\n    return new DiscordjsMember(this._message.author, this._message.guild);\n  }\n\n  get guild() {\n    return new DiscordjsGuild(this._message.guild);\n  }\n\n  get content() {\n    return this._message.content;\n  }\n\n  get author() {\n    return new DiscordjsUser(this._message.author);\n  }\n}\n\nclass DiscordjsGuild extends Guild {\n  constructor(guild) {\n    super(guild);\n  }\n}\n\nclass DiscordjsUser extends User {\n  constructor(user) {\n    super(user);\n  }\n}\n\nclass DiscordjsMember extends DiscordjsUser {\n  constructor(user, guild) {\n    super(user);\n    this._guild = guild;\n  }\n\n  get highestRole() {\n    return this._guild.members.find(\"id\", this._user.id).highestRole.name.replace(/@/g, \"AT\");\n  }\n\n  get highestRole() {\n    return this.roles.reduce((prev, role) =>\n      !prev || role.position > prev.position ||(role.position === prev.position && role.id < prev.id) ? role : prev);\n  }\n}\n\n"]}